<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Manuel utilisateur ‚Äì OpenAPS AIMI</title>

  <style>
    /* -------------------------
       LIGHT / DARK THEME
    --------------------------*/
    :root {
      --bg:#ffffff;
      --text:#111;
      --muted:#666;
      --accent:#1a73e8;
      --card:#f3f3f3;
      --code-bg:rgba(0,0,0,0.06);
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg:#0f1113;
        --text:#e4e7eb;
        --muted:#9aa0a6;
        --accent:#8ab4f8;
        --card:#1b1d1f;
        --code-bg:rgba(255,255,255,0.08);
      }
    }

    body {
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: -apple-system, BlinkMacSystemFont, Roboto, Arial;
      line-height:1.6;
    }

    /* -------------------------
       HEADER + HAMBURGER MENU
    --------------------------*/
    header {
      position:fixed;
      top:0;
      z-index:9999;
      background:var(--card);
      backdrop-filter:blur(6px);
      padding:10px 14px;
      display:flex;
      align-items:center;
      border-bottom:1px solid rgba(0,0,0,0.12);
      width: 100%;
      left: 0;
      right: 0;
    }

    .hamburger {
      width:40px;
      height:40px;
      border:none;
      background:none;
      display:flex;
      justify-content:center;
      align-items:center;
      cursor:pointer;
    }
    .hamburger .bars {
      width:22px;
      height:2px;
      background:var(--text);
      box-shadow:0 6px 0 var(--text), 0 -6px 0 var(--text);
      border-radius:2px;
    }

    .titlebox {
      margin-left:12px;
    }
    .titlebox .title { font-size:16px; font-weight:600; }
    .titlebox .subtitle { font-size:12px; color:var(--muted); }

    /* -------------------------
       DROPDOWN TOC
    --------------------------*/
    .toc-dropdown {
      position:fixed;
      top:70px;
      left:0;
      right:0;
      background:var(--card);
      max-height:0;
      overflow:hidden;
      transition:max-height .25s ease;
      z-index:9990;
      border-bottom:1px solid rgba(0,0,0,0.12);
      padding-left:0;
      padding-right:0;
    }

    .toc-dropdown.open {
      max-height:150vh;
      padding:12px 16px;
      overflow-y: auto;
    }

    #tocListContent {
    margin: 0;
    padding: 0;
    box-sizing: border-box; /* Garanzia che non ci siano margini nascosti */
}

    .toc-dropdown a {
      display:block;
      padding:8px;
      border-radius:6px;
      text-decoration:none;
      color:var(--text);
    }
    .toc-dropdown a:hover {
      background:rgba(0,0,0,0.08);
      color:var(--accent);
    }
    /* -------------------------
       CONTENT
    --------------------------*/
    main {
      max-width:900px;
      margin:0 auto;
      padding:70px 16px 60px;
    }

    h1 { font-size:1.55rem; }
    h2 { font-size:1.28rem; margin-top:36px; }
    h3 { font-size:1.15rem; margin-top:26px; }

    img { max-width:100%; margin:14px 0; border-radius:4px; }

    /* scroll tabelle */
    .table-container {
      overflow-x:auto;
      margin:8px 0 18px;
    }
    table {
      min-width:600px;
      border-collapse:collapse;
      width:100%;
    }
    th,td {
      border-bottom:1px solid rgba(0,0,0,0.12);
      padding:8px 10px;
      text-align:left;
    }

    /* code highlight */
    code {
      background:var(--code-bg);
      padding:3px 6px;
      border-radius:6px;
      font-family: "Roboto Mono", monospace;
    }
    pre code {
      background:#202124;
      color:#e8eaed;
      display:block;
      padding:12px;
      border-radius:8px;
      overflow:auto;
    }

  </style>
</head>

<body>

<header>
  <button class="hamburger" id="hamburger"><span class="bars"></span></button>
  <div class="titlebox">
    <div class="title">Manuel utilisateur ‚Äì OpenAPS AIMI</div>
    <div class="subtitle">Version PRO</div>
  </div>
</header>

<nav id="tocDropdown" class="toc-dropdown"></nav>

<main>
# Manuel utilisateur ‚Äì OpenAPS AIMI

Bienvenue dans AIMI (Adaptive Insulin Management Intelligence), le moteur pr√©dictif d'AndroidAPS qui combine apprentissage automatique, surveillance physiologique et garde-fous avanc√©s pour piloter basal et SMB (Super Micro-Bolus). AIMI observe votre historique glyc√©mique, vos bolus, vos pas/rythme cardiaque et vos modes d√©clar√©s pour ajuster dynamiquement sensibilit√©, dur√©e d'action de l'insuline et micro-bolus, tout en conservant les s√©curit√©s OpenAPS historiques.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OpenAPSAIMIPlugin.kt‚Ä†L95-L175„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2480-L2648„Äë

AIMI n'est pas une bo√Æte noire : pensez-le comme un co-pilote. Plus vos donn√©es sont propres (profil √† jour, enregistrement des repas, fermeture des boucles nocturnes), plus AIMI anticipe finement et stabilise vos glyc√©mies.


## Installation et activation <a id="installation-et-activation"></a>
1. **Activez le plugin** depuis *Configuration ‚ñ∂Ô∏è Plugins ‚ñ∂Ô∏è APS* et cochez **OpenAPS AIMI**. AIMI v√©rifie automatiquement que votre pompe accepte les basales temporaires.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OpenAPSAIMIPlugin.kt‚Ä†L226-L238„Äë
2. **Red√©marrez la boucle** : au d√©marrage AIMI recharge vos sensibilit√©s variables pass√©es et installe son calculateur Kalman/PK-PD.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OpenAPSAIMIPlugin.kt‚Ä†L140-L175„Äë
3. **Autorisez les permissions** : si vous activez les pas/FC, assurez-vous que la montre Wear OS synchronise bien vers AAPS (voir section ‚ù§Ô∏è).
4. **V√©rifiez l'√©tat**
   - L'√©cran OpenAPS affiche *Algorithme AIMI* et la date du dernier calcul (`lastAPSRun`).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OpenAPSAIMIPlugin.kt‚Ä†L162-L165„Äë
   - Les logs contiennent des raisons `AIMI+` lorsque l'adaptatif basal d√©clenche un kicker ou une micro-reprise.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/AIMIAdaptiveBasal.kt‚Ä†L79-L112„Äë
   - Les colonnes `SMB`/`Basal` du statut montrent les multiplicateurs WCycle ou NightGrowth lorsqu'ils sont actifs.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2493-L2531„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L417-L444„Äë

---

<h2 id="principes-generaux-et-verification-du-fonctionnement">Principes g√©n√©raux et v√©rification du fonctionnement</h2>
- **Boucle compl√®te** : AIMI r√©cup√®re le `GlucoseStatusAIMI`, calcule un plan basale via `BasalPlanner`, applique `AIMIAdaptiveBasal` pour les plateaux et ajuste les SMB via PK/PD et ISF adaptatif.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/basal/BasalDecisionEngine.kt‚Ä†L25-L113„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/PkPdIntegration.kt‚Ä†L27-L109„Äë
- **Apprentissage continu** : les param√®tres PK/PD (DIA et temps de pic) sont mis √† jour lorsqu'assez d'IOB est disponible, sauf si du sport ou des graisses retard√©es sont d√©tect√©s.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/AdaptivePkPdEstimator.kt‚Ä†L20-L52„Äë
- **Logs utiles** : `rT.reason` inclut les d√©clencheurs (plateau kicker, NGR, WCycle). Les CSV AIMI (`AAPS/oapsaimi*.csv`) enregistrent chaque d√©cision pour analyse ult√©rieure.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L205-L276„Äë

---

<h2 id="reglages-generaux">üîß R√©glages g√©n√©raux</h2>
Ces param√®tres posent la base physiologique utilis√©e par toutes les briques AIMI.

### üîπ `OApsAIMIMLtraining`
- **Valeur par d√©faut :** `false` (d√©sactiv√©).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L123-L136„Äë
- **But :** autoriser l'entra√Ænement du mod√®le SMB local (fichier `oapsaimiML_records.csv`).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L205-L223„Äë
- **Effet :** en mode entra√Ænement, AIMI consigne vos boucles pour affiner le r√©seau `neuralnetwork5` apr√®s accumulation d'au moins 60 min de donn√©es.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L236-L244„Äë
- **Ajuster si :**
  - **Hypos fr√©quentes :** laissez d√©sactiv√© le temps d'identifier la source avant de r√©entra√Æner.
  - **Hypers fr√©quentes :** activez pour apprendre vos patterns, mais surveillez la s√©curit√© (SMB est toujours born√©).
  - **Variabilit√© :** n'entra√Ænez qu'apr√®s avoir stabilis√© vos profils (au moins 3-4 jours de donn√©es homog√®nes).

### üîπ `OApsAIMIweight`, `OApsAIMICHO`, `OApsAIMITDD7`
- **Valeurs par d√©faut :** 50‚ÄØkg, 50‚ÄØg, 40‚ÄØU respectivement.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L67-L69„Äë
- **But :** renseigner des bornes physiologiques utilis√©es pour initialiser le filtre de Kalman ISF et la PK/PD si votre historique est vide.
- **Effet :** un poids/TDD sous-estim√© rendra l'ISF trop agressif; un CHO moyen trop faible d√©tectera plus souvent des repas ¬´ gras ¬ª.
- **Ajuster :**
  - **Hypos :** augmentez l√©g√®rement `OApsAIMIweight` ou `OApsAIMITDD7` vers vos valeurs r√©elles ‚Üí l'ISF se radoucit.
  - **Hypers :** ajustez `OApsAIMICHO` vers vos apports r√©els pour que les mod√®les repas restent r√©alistes.
  - **Variabilit√© :** harmonisez ces param√®tres avec votre profil (m√™mes unit√©s que les rapports journaliers).

### üîπ `AimiUamConfidence`
- **Valeur par d√©faut :** `0.5` (confiance moyenne).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L144-L146„Äë
- **But :** pond√©rer l'apprentissage ¬´ UAM ¬ª quand la d√©tection de repas non annonc√©s est fiable.
- **Effet :** plus la confiance est √©lev√©e, moins l'algorithme dynamique de sensibilit√© (IsfAdjustmentEngine) s'√©loigne du profil.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/ISF/IsfAdjustmentEngine.kt‚Ä†L13-L36„Äë
- **Ajuster :**
  - **Hypos post-UAM :** augmentez (0.6‚Äì0.8) pour limiter la baisse d'ISF.
  - **Hyper prolong√©es non annonc√©es :** r√©duisez (0.3‚Äì0.4) afin que l'ISF s'adapte plus vite.
  - **Variabilit√© :** laissez par d√©faut le temps que le moteur accumule assez de Kalman trust.

### üîπ `OApsAIMIEnableBasal`
- **Valeur par d√©faut :** `false`.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L123-L136„Äë
- **But :** activer une basale pr√©dictive sp√©cifique (legacy). Actuellement non utilis√©e (comment√©e) : laissez d√©sactiv√© sauf demande sp√©cifique.

### üîπ `OApsAIMIautoDrive`
- **Valeur par d√©faut :** `false`.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L130-L136„Äë
- **But :** activer l'autoDrive, c‚Äôest-√†-dire l‚Äôutilisation automatique des facteurs modes (repas, auto-bolus) et du profil combin√© (`combinedDelta`).
- **Effet :** applique les facteurs `autodrivePrebolus`, `autodrivesmallPrebolus`, limite le basal via `autodriveMaxBasal` et ajuste les d√©clencheurs `combinedDelta`/`AutodriveDeviation`.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L105-L114„Äë
- **Ajuster :** commencez par OFF, puis activez lorsque vos modes repas sont bien renseign√©s.

### üîπ Param√®tres cibles AutoDrive (`OApsAIMIAutodriveBG`, `OApsAIMIAutodriveTarget`)
- **Valeurs par d√©faut :** 90 et 70‚ÄØmg/dL.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L83-L86„Äë
- **Effet :** servent de r√©f√©rences pour la d√©tection d'√©carts minimes et le d√©clenchement des micro-pr√©bolus autoDrive.
- **Conseil :** Gardez `AutodriveBG` au-dessus de votre cible r√©elle (‚âà‚ÄØ90‚Äì100) pour laisser AIMI absorber les petites remont√©es sans sur-corriger.

---

<h2 id="regulation-basale-smb">‚öôÔ∏è R√©gulation basale & SMB</h2>
AIMI contr√¥le simultan√©ment la basale temporaire (kickers, anti-stall) et l'intensit√© des SMB via ses param√®tres.

### Param√®tres SMB globaux
| Param√®tre | Valeur par d√©faut | R√¥le | Ajustement hypos | Ajustement hypers | Variabilit√© |
|-----------|------------------|------|------------------|-------------------|-------------|
| `OApsAIMIMaxSMB` | 1.0‚ÄØU | plafond SMB standard | ‚Üì √† 0.7‚Äì0.8 si hypos apr√®s SMB | ‚Üë jusqu'√† 1.2 si post-prandiales hautes | combinez avec facteurs repas |„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L64-L66„Äë|
| `OApsAIMIHighBGMaxSMB` | 1.0‚ÄØU | plafond SMB lorsque AIMI d√©tecte un haut plateau | idem | ‚Üë (1.5) pour corriger plus vite un plateau >180‚ÄØmg/dL | Surveillez NGR |„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L64-L66„Äë|
| `autodriveMaxBasal` | 1.0‚ÄØU/h | plafond basale autoDrive | ‚Üì si hypos nocturnes | ‚Üë (√ó1.2) si plateau hyper en autoDrive | Coupl√© √† anti-stall |„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L105-L114„Äë|
| `meal_modes_MaxBasal` | 1.0‚ÄØU/h | plafond basale durant modes repas | idem | ‚Üë (√ó1.3) si vous tol√©rez plus en repas longs | Laisser > basale profil |„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L113-L115„Äë|

**Astuce :** Les plafonds SMB/basal sont appliqu√©s apr√®s toutes les s√©curit√©s (`applyMaxLimits`).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L296-L308„Äë

### Intervalles SMB / modes
Les pr√©f√©rences `OApsAIMIHighBGinterval`, `OApsAIMImealinterval`, etc., d√©finissent la fr√©quence minimale (par 5‚ÄØmin) √† laquelle AIMI peut reproposer un SMB en mode correspondant (par d√©faut 3 √ó 5‚ÄØmin = 15‚ÄØmin).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L75-L82„Äë
- **Hypos :** augmentez l‚Äôintervalle (4‚Äì5) pour espacer les SMB.
- **Hypers prolong√©es :** r√©duisez √† 2 (10‚ÄØmin) pour HighBG seulement.

### AIMIAdaptiveBasal (plateaux, micro-reprises)
- **Seuil haut** `OApsAIMIHighBg` = 180‚ÄØmg/dL : d√©clenche les kicks lorsqu‚Äôun plateau haut est identifi√©.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L135-L143„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/AIMIAdaptiveBasal.kt‚Ä†L62-L112„Äë
- **Bande plateau** `OApsAIMIPlateauBandAbs` = ¬±2.5‚ÄØmg/dL/5‚ÄØmin : plus la bande est large, plus AIMI tol√®re des variations avant de kick-er.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L135-L143„Äë
- **Multiplicateur max** `OApsAIMIMaxMultiplier` = √ó1.6 : limite la basale temporaire en plateau.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L135-L143„Äë
- **Kicker step/min** (`OApsAIMIKickerStep`, `OApsAIMIKickerMinUph`, `OApsAIMIKickerStartMin`, `OApsAIMIKickerMaxMin`) contr√¥lent l‚Äôintensit√© et la dur√©e du kicker.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L138-L140„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L93-L98„Äë
- **Micro-reprise** (`OApsAIMIZeroResumeMin`, `OApsAIMIZeroResumeFrac`, `OApsAIMIZeroResumeMax`) : relance une basale faible apr√®s un arr√™t ‚â•10‚ÄØmin pour √©viter les remont√©es post-hypo.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L141-L142„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L96-L97„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/AIMIAdaptiveBasal.kt‚Ä†L79-L112„Äë
- **Anti-stall** `OApsAIMIAntiStallBias` (10‚ÄØ%) et `OApsAIMIDeltaPosRelease` (Œî+1 mg/dL) d√©finissent l‚Äôoverdrive minimal en plateau collant.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L142-L143„Äë

**D√©cision tree pratique :**
```
Si plateau >180 mg/dL et Œî‚âà0 ‚Üí augmenter `OApsAIMIKickerStep` (+0,05) pour corriger plus vite.
Si hypos apr√®s reprise basale ‚Üí r√©duire `OApsAIMIZeroResumeFrac` (0,2) ou augmenter `ZeroResumeMin` (15 min).
Si mont√©e lente malgr√© kicks ‚Üí augmenter `OApsAIMIMaxMultiplier` (1,8 max) et v√©rifier `KickerMinUph`.
```

### S√©curit√© hypoglyc√©mie
AIMI applique un garde-fou qui bloque SMB si la glyc√©mie se rapproche du seuil hypo avec pente n√©gative, en tenant compte d'une marge suppl√©mentaire selon la vitesse de chute.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L400-L413„Äë

---

<h2 id="intelligence-adaptative">üß† Intelligence adaptative (ISF, PeakTime, PK/PD)</h2>

### PK/PD dynamique
- **Activation** : `OApsAIMIPkpdEnabled` (OFF par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L130-L136„Äë
- **Param√®tres initiaux** (`OApsAIMIPkpdInitialDiaH`, `OApsAIMIPkpdInitialPeakMin`) d√©finissent le DIA (20‚ÄØh) et pic (40‚ÄØmin).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L71-L80„Äë
- **Bornes & vitesse** (`OApsAIMIPkpdBoundsDia*`, `OApsAIMIPkpdBoundsPeak*`, `OApsAIMIPkpdMax*`) limitent l‚Äôapprentissage quotidien.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L71-L78„Äë
- **√âtat persistant** (`OApsAIMIPkpdStateDiaH`, `OApsAIMIPkpdStatePeakMin`) m√©morise le dernier DIA/pic appris.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L79-L80„Äë
- **Effet :** lorsque activ√©, AIMI fusionne l‚ÄôISF profil/TDD avec l‚Äôestimation PK/PD et applique un *pkpdScale* li√© √† la fraction de queue d‚ÄôIOB.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/PkPdIntegration.kt‚Ä†L27-L82„Äë
- **Priorit√© repas :** lorsque les modes repas/COB actifs annoncent une mont√©e, le *pkpdScale* est relev√© (planche 0.9 ‚Üí plafond 1.5) et les gardes SMB sont assouplies pour conserver de petits bolus rapproch√©s tant que la pr√©diction reste au-dessus de la cible.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/PkPdIntegration.kt‚Ä†L1-L86„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L1180-L1360„Äë
- **Ajustements :**
  - **Hypos tardives** : r√©duisez `OApsAIMIPkpdMaxDiaChangePerDayH` pour freiner l‚Äôallongement de DIA.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L77-L78„Äë
  - **Hypers post-repas** : baissez `OApsAIMIPkpdBoundsPeakMinMax` (ex. 180) pour favoriser des pics plus courts.
  - **Donn√©es instables** : d√©sactivez temporairement `PkpdEnabled` et revenez aux valeurs initiales (reset via pr√©f√©rences).

### Fusion ISF & blending rapide
- **`OApsAIMIIsfFusionMinFactor` / `MaxFactor`** : facteurs min/max appliqu√©s √† l‚ÄôISF de profil (0.75‚Äì2.0 par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L81-L83„Äë
- **`OApsAIMIIsfFusionMaxChangePerTick`** : variation max ¬±40‚ÄØ% par tick de 5‚ÄØmin.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L81-L83„Äë
- **Effet :** la fusion m√©lange l‚ÄôISF TDD/PkPd et le Kalman rapide via `IsfBlender`, respectant un lissage ¬±5‚ÄØ% par boucle.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/ISF/IsfBlender.kt‚Ä†L5-L45„Äë

### Ajustement adaptatif ISF
`IsfAdjustmentEngine` utilise la glyc√©mie Kalman et une EMA du TDD pour recalculer l‚ÄôISF cible (loi logarithmique) tout en limitant le changement √† ¬±5‚ÄØ% par boucle et ¬±20‚ÄØ% par heure.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/ISF/IsfAdjustmentEngine.kt‚Ä†L6-L49„Äë
- **Hypos** : r√©duisez `AimiUamConfidence` ou d√©sactivez PK/PD si l‚ÄôISF chutait trop vite.
- **Hypers** : v√©rifiez que `OApsAIMIIsfFusionMaxFactor` reste ‚â•1.6.

### SMB damping intelligent
Les param√®tres `OApsAIMISmbTailThreshold`, `OApsAIMISmbTailDamping`, `OApsAIMISmbExerciseDamping`, `OApsAIMISmbLateFatDamping` contr√¥lent la r√©duction des SMB en fin d‚Äôaction, apr√®s exercice ou repas gras.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L84-L87„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/SmbDamping.kt‚Ä†L4-L77„Äë
- **Conseil :**
  - Si vous restez haut en fin d‚Äôaction ‚Üí augmentez `SmbTailThreshold` (0.35) ou relevez `SmbTailDamping` (0.6).
  - Si hypos apr√®s sport ‚Üí r√©duisez `SmbExerciseDamping` (0.4) pour couper plus fort.

### PeakTime dynamique
Le calcul `calculateDynamicPeakTime` combine IOB, activit√© future, pas, FC, et capteur pour ajuster le temps de pic entre 35 et 120‚ÄØmin.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2533-L2645„Äë
- **Hypos nocturnes** : si le pic est trop court, augmentez `OApsAIMIcombinedDelta` (1.5) pour rendre AIMI plus prudent dans l‚ÄôautoDrive.
- **Hypers post-prandiales** : assurez-vous que les pas/FC sont bien synchronis√©s pour autoriser un pic raccourci lorsque vous √™tes actif.

---

<h2 id="modes-detection-repas">üí° Modes & d√©tection repas</h2>
AIMI module ses SMB selon vos modes temporels et vos facteurs d√©di√©s.

### Facteurs journaliers
`OApsAIMIMorningFactor`, `OApsAIMIAfternoonFactor`, `OApsAIMIEveningFactor` (d√©faut 50‚ÄØ%) pond√®rent le SMB pr√©dit selon la tranche horaire.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L88-L101„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L236-L245„Äë
- **Hypos matinales** : r√©duisez le MorningFactor (40‚ÄØ%).
- **Hypers soir√©e** : augmentez EveningFactor (60‚Äì70‚ÄØ%).

### Modes repas sp√©cifiques
Chaque mode dispose d‚Äôun trio *(pr√©bolus1, pr√©bolus2, facteur %)* et d‚Äôun intervalle :
- **Petit d√©jeuner** : `OApsAIMIBFPrebolus` (2.5‚ÄØU), `OApsAIMIBFPrebolus2` (2.0‚ÄØU), `OApsAIMIBFFactor` (50‚ÄØ%), intervalle 15‚ÄØmin.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L95-L101„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L81-L82„Äë
- **D√©jeuner / D√Æner** : param√®tres analogues (`Lunch*`, `Dinner*`).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L98-L101„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L76-L79„Äë
- **Snack / HighCarb / Meal g√©n√©riques** : `OApsAIMISnackPrebolus`, `OApsAIMIHighCarbPrebolus`, etc.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L120-L123„Äë
- **Hyper mode** : `OApsAIMIHyperFactor` (60‚ÄØ%) renforce les SMB si BG>180.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L100-L103„Äë

**Astuces :**
- Utilisez `OApsAIMImealinterval` (15‚ÄØmin par d√©faut) pour √©viter les SMB trop rapproch√©s pendant un repas prolong√©.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L75-L82„Äë
- `OApsAIMIMealFactor` p√®se le SMB m√™me sans mode explicite (utile pour repas surprises).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L91-L101„Äë

### AutoDrive pr√©bolus
`OApsAIMIautodrivePrebolus` (1‚ÄØU) et `OApsAIMIautodrivesmallPrebolus` (0.1‚ÄØU) servent de limites pour des micro-pr√©bolus automatiques lorsque `autoDrive` est actif.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L105-L107„Äë

### Gestion notes & d√©tection repas
AIMI scanne vos notes (sleep, sport, meal‚Ä¶) pour activer les modes si vous oubliez de cliquer sur le bouton, et les enregistre dans les logs SMB.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2656-L2678„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L311-L360„Äë

---

<h2 id="exercice-regles-securite">üí™ Exercice & r√®gles de s√©curit√©</h2>

### Toggles physiologiques
- **`OApsAIMIpregnancy`**, **`OApsAIMIhoneymoon`** : activent des ajustements sp√©cifiques dans `BasalDecisionEngine` (par ex. augmenter la basale si delta>0 pendant la grossesse).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L123-L136„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/basal/BasalDecisionEngine.kt‚Ä†L53-L63„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/basal/BasalDecisionEngine.kt‚Ä†L461-L463„Äë
- **`OApsAIMIforcelimits`** : forcer les plafonds basale/SMB (utilis√© par certains profils). Laissez OFF sauf recommandation clinique.

### D√©tection sport & s√©curit√© SMB
- Les r√®gles `isSportSafetyCondition` coupent les SMB lorsque pas/FC indiquent une activit√© intense, ou lorsque la cible est √©lev√©e (>140).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L342-L350„Äë
- `applySpecificAdjustments` r√©duit de moiti√© les SMB si vous √™tes en sommeil/snack/basse activit√© prolong√©e.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L353-L360„Äë

### D√©cision tree s√©curit√©
```
Si hypos apr√®s sport ‚Üí activer `OApsAIMIEnableStepsFromWatch` + r√©duire `SmbExerciseDamping`.
Si hypos grossesse ‚Üí r√©duire `OApsAIMIMaxMultiplier` et v√©rifier `pregnancy` activ√©.
Si hypers en lune de miel ‚Üí activer `OApsAIMIhoneymoon` pour autoriser plus d'agressivit√©.
```

---

<h2 id="mode-nuit-croissance-nocturne">üåô Mode nuit & croissance nocturne</h2>

### Mode nuit classique
- **Toggle** `OApsAIMInight` (OFF par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L127-L129„Äë
- **Facteur sommeil** `OApsAIMIsleepFactor` (60‚ÄØ%) et intervalle `OApsAIMISleepinterval` (15‚ÄØmin) mod√®rent les SMB durant la nuit.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L102-L103„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L81-L82„Äë

### Night Growth Resistance (NGR)
Ce module g√®re les pics d'hormone de croissance chez l'enfant/adolescent.
- **Activation** : auto pour <18‚ÄØans ou via `OApsAIMINightGrowthEnabled` (ON par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L133-L136„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L417-L444„Äë
- **Param√®tres cl√©s** :
  - `OApsAIMINightGrowthAgeYears` (14‚ÄØans), fen√™tres `OApsAIMINightGrowthStart`/`End` (22:00‚Äì06:00).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L87-L90„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/StringKey.kt‚Ä†L56-L61„Äë
  - `OApsAIMINightGrowthMaxIobExtra` = marge d'IOB autoris√©e par tranche de 30‚ÄØmin lorsque l'√©pisode est actif.„ÄêF:plugins/aps/src/main/res/values/strings.xml‚Ä†L543-L544„Äë
- **Fonctionnement** : les seuils de pente/dur√©e, les multiplicateurs SMB/basal et la phase de d√©croissance sont d√©sormais apprises automatiquement √† partir de l'autosens, de la DIA, de la stabilit√© CGM et du profil basale.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L420-L471„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/NightGrowthResistanceLearner.kt‚Ä†L1-L59„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/NightGrowthResistanceMonitor.kt‚Ä†L13-L215„Äë

**Conseils :**
- Ajustez uniquement la fen√™tre horaire et l'IOB suppl√©mentaire si la croissance d√©borde encore les plafonds.
- Pour les plus jeunes, r√©duisez la tranche horaire si l'√©pisode commence plus t√¥t/laissez le learner d√©cider des intensit√©s.

---

<h2 id="integrazione-frequenza-cardiaca">‚ù§Ô∏è Int√©gration fr√©quence cardiaque & pas (Wear OS)</h2>
- **Activation** : `OApsAIMIEnableStepsFromWatch` (OFF par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L123-L129„Äë
- **Effets** :
  - Les pas sur 5‚Äì180‚ÄØmin (`recentSteps*`) et la FC moyenne 5/60/180‚ÄØmin sont utilis√©s pour ajuster le temps de pic, moduler SMB (sport) et d√©cider des reprises basales.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L848-L911„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2539-L2645„Äë
  - En cas d'activit√© intense (>1000 pas et FC>110), AIMI allonge le pic (√ó1.2) et limite SMB.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2616-L2626„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L342-L350„Äë
  - Au repos (pas<200, FC<50), le pic est raccourci (√ó0.75) pour √©viter les retards d'action.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2618-L2626„Äë

**Astuces :**
- V√©rifiez que la montre transmet bien toutes les 5‚ÄØmin (sinon les valeurs resteront nulles et AIMI n'ajustera pas).
- En cas d'hypos √† l'effort, r√©duisez `SmbExerciseDamping` ou d√©sactivez temporairement l'option.

---

<h2 id="wcycle-suivi-cycle-menstruel">‚ôÄÔ∏è WCycle ‚Äì suivi du cycle menstruel</h2>
AIMI peut adapter basales et SMB selon votre phase menstruelle.

### Activation & mode
- **`OApsAIMIwcycle`** : active le module (OFF par d√©faut).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L130-L134„Äë
- **Modes de suivi** : `OApsAIMIWCycleTrackingMode` (`FIXED_28`, `CALENDAR_VARIABLE`, etc.).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/StringKey.kt‚Ä†L56-L59„Äë
- **Param√®tres physiologiques** : contraceptif, statut thyro√Øde, Verneuil influencent l'amplitude des multiplicateurs.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/StringKey.kt‚Ä†L56-L59„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/wcycle/WCycleTypes.kt‚Ä†L1-L39„Äë
- **Clamp min/max** (`OApsAIMIWCycleClampMin` 0.8, `ClampMax` 1.25) bornent l'√©chelle appliqu√©e.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L124-L126„Äë
- **Options shadow/confirm** :
  - `OApsAIMIWCycleShadow` garde les calculs sans les appliquer (mode observation).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L132-L135„Äë
  - `OApsAIMIWCycleRequireConfirm` demande une confirmation avant d'appliquer un changement.„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/BooleanKey.kt‚Ä†L132-L135„Äë

### Fonctionnement
- `ensureWCycleInfo()` interroge `WCycleFacade` avec vos pr√©f√©rences et renvoie la phase, les multiplicateurs et un texte `reason` inject√© dans les logs.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2493-L2517„Äë
- `updateWCycleLearner` ajuste les multipliers appris tout en respectant `ClampMin/Max`.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2521-L2531„Äë
- Les valeurs de base suivent `WCycleDefaults` (ex. +12‚ÄØ% basal en phase lut√©ale).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/wcycle/WCycleTypes.kt‚Ä†L18-L38„Äë

**Conseils :**
- D√©finissez la dur√©e moyenne (`OApsAIMIWCycleAvgLength`, 28‚ÄØj) et le jour de d√©but (`OApsAIMIwcycledateday`).„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/IntKey.kt‚Ä†L86-L87„Äë„ÄêF:core/keys/src/main/kotlin/app/aaps/core/keys/DoubleKey.kt‚Ä†L124-L126„Äë
- En cas de contraception hormonale, l‚Äôamplitude est automatiquement r√©duite (√ó0.4‚Äì0.5).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/wcycle/WCycleTypes.kt‚Ä†L23-L30„Äë

---

<h2 id="consigli-aggiustamento-rapido">Conseils d'ajustement rapide</h2>
| Situation | Ajustement sugg√©r√© | Pr√©f√©rence li√©e |
|-----------|-------------------|-----------------|
| Hypos post-SMB | ‚Üì `OApsAIMIMaxSMB`, ‚Üë `OApsAIMISmbTailDamping` | SMB & PK/PD |
| Hypos nocturnes | ‚Üë `OApsAIMIZeroResumeMin`, ‚Üì `NightGrowthBasalMultiplier` | Basal & Night |
| Hypers post-repas | ‚Üë facteurs repas (60‚Äì70‚ÄØ%), ‚Üì `OApsAIMIPkpdBoundsPeakMinMax` | Modes & PK/PD |
| Hyper plateau plat | ‚Üë `OApsAIMIKickerStep`, v√©rifier `HighBGMaxSMB` | Adaptive Basal |
| Variabilit√© forte | Stabiliser poids/TDD, d√©sactiver `PkpdEnabled`, activer `Shadow` WCycle | G√©n√©ral & WCycle |

### Mini decision tree quotidien
```
Si vous restez >180 mg/dL malgr√© SMB ‚Üí v√©rifier HighBG mode : augmenter `HighBGMaxSMB` et `HyperFactor`.
Si descente trop rapide apr√®s autoDrive ‚Üí diminuer `autodrivePrebolus` et augmenter `AutodriveDeviation` (1.5).
Si tendance haute pendant activit√© ‚Üí activer suivi pas/FC et r√©duire `SmbExerciseDamping` pour conserver un peu de SMB.
```

---

<h2 id="depannage-interpretazione-logs">D√©pannage et interpr√©tation des logs</h2>
1. **Lire `rT.reason`** : chaque boucle concat√®ne les motifs (`plateau kicker`, `WCycle`, `NGR`). Cherchez les phrases `AIMI+` pour voir les actions adaptatives.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/AIMIAdaptiveBasal.kt‚Ä†L79-L112„Äë„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/DetermineBasalAIMI2.kt‚Ä†L2493-L2531„Äë
2. **CSV AIMI** : `_records.csv` contient toutes les variables (pas, TDD, ISF). Utile pour v√©rifier si vos modes ou pas sont bien pris en compte.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L205-L276„Äë
3. **PK/PD ne s'actualise plus** : v√©rifiez que `PkpdEnabled` est ON et que vous n'√™tes pas en exercice (flag coupe l‚Äôapprentissage).„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/pkpd/AdaptivePkPdEstimator.kt‚Ä†L20-L38„Äë
4. **Retour aux d√©fauts** : chaque cl√© peut √™tre r√©initialis√©e depuis le menu (valeurs par d√©faut list√©es plus haut). Si vous voulez un reset complet, d√©sactivez `PkpdEnabled`, supprimez les fichiers `oapsaimi*_records.csv`, puis r√©activez.
5. **Aucun SMB** : v√©rifiez les s√©curit√©s `isCriticalSafetyCondition` (BG over target, delta n√©gatif, etc.) et les plafonds `maxIob`/`maxSMB`.„ÄêF:plugins/aps/src/main/kotlin/app/aaps/plugins/aps/openAPSAIMI/OapsAIMIsmb.kt‚Ä†L296-L339„Äë

---

<h2 id="recapitulatif-pedagogique">R√©capitulatif p√©dagogique</h2>
AIMI est un co-pilote adaptatif :
- Il observe vos glyc√©mies, vos efforts et vos modes pour ajuster l‚ÄôISF, le temps de pic et les SMB.
- Ses garde-fous (plateau kicker, NGR, damping SMB, s√©curit√© sport) √©vitent les extr√™mes tout en laissant l‚Äôapprentissage √©voluer.
- Laisser AIMI accumuler des donn√©es coh√©rentes (profil √† jour, annonces repas, √©tapes/pulsations fiables) maximise ses performances. Chaque param√®tre est ajustable pour refl√©ter votre r√©alit√©, mais changez un seul r√©glage √† la fois pour en lire l‚Äôimpact dans les logs.

Continuez √† collaborer avec AIMI : plus vous fournissez des donn√©es stables, plus il affine ses pr√©dictions et maintient votre glyc√©mie dans la cible.
</main>


<script>
    (function() {

      /* Toggle TOC */
      const toc = document.getElementById("tocDropdown");
      const ham = document.getElementById("hamburger");
      ham.onclick = () => toc.classList.toggle("open");

      /* Build TOC automatically from headings */
      const headers = Array.from(document.querySelectorAll("h1, h2, h3"))
        .filter(h => h.id);

      const list = document.createElement("div");
      list.id = "tocListContent";

      headers.forEach(h => {
        const a = document.createElement("a");
        a.href = "#" + h.id;
        a.textContent = h.textContent;

        a.onclick = function(e) {
          e.preventDefault();
          toc.classList.remove("open");
          const target = document.getElementById(h.id);

          if (target) {
            // Calcoliamo l'offset (posizione dell'elemento - altezza header)
            const offset = target.offsetTop - 70;

            // CORREZIONE CRITICA: Uso di window.scrollTo(x, y) per massima compatibilit√† con WebView
            window.scrollTo(0, offset);

            // Nota: La riga precedente sostituisce la meno compatibile:
            // window.scrollTo({ top: target.offsetTop - 70, behavior: "smooth" });
          }
        };
        list.appendChild(a);
      });

      toc.appendChild(list);

      /* Wrap tables */
      document.querySelectorAll("table").forEach(tbl => {
        const wrap = document.createElement("div");
        wrap.className = "table-container";
        tbl.parentNode.insertBefore(wrap, tbl);
        wrap.appendChild(tbl);
      });

    })();
</script>

</body>
</html>
